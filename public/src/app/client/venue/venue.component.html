<div class="col align-self-center" *ngIf="!loaded; else mainTemplate">
    <div class="loading">
        <mat-spinner color="accent"></mat-spinner>
    </div>
</div>
<ng-template #mainTemplate>
    <div class="containerX">
        <div id="slider">
            <figure *ngFor="let gallery of venue.gallery">
                <!-- LIVE -->
                <img src="https://s3-us-west-2.amazonaws.com/tulsa-venues/Venues/{{venue._id}}/Gallery/{{gallery.name}}" alt>
                <!-- TEST -->
                <!-- <img src='https://venue-test.s3.amazonaws.com/Venues/{{venue._id}}/Gallery/{{gallery.name}}' alt> -->
            </figure>
        </div>
        <div class="container-fluid">
            <div class="row" id="top">
                <div class="col-3" id="left-col">
                    <div class="top-left">
                        <div class="mx-auto" id="rating">
                            <i class="material-icons" value="1">&#xE83A;</i>
                            <i class="material-icons" value="2">&#xE83A;</i>
                            <i class="material-icons" value="3">&#xE83A;</i>
                            <i class="material-icons" value="4">&#xE83A;</i>
                            <i class="material-icons" value="5">&#xE83A;</i>
                        </div>
                        <ul class="text-left">
                            <li>
                                <h5 class="black">{{venue.address}}, {{venue.city}} {{venue.state | uppercase}}</h5>

                            </li>
                            <li>
                                <a href='tel:{{ venue.phone }}' data-type='phone'>
                                    <p>{{ venue.phone }}</p>
                                </a>
                            </li>
                            <li>
                                <a href='http://{{venue.website}}' target='_blank' rel='nofollow noopener noreferrer' matTooltip="View {{venue.name}}'s' website">
                                    <p><span class="color">{{venue.website}}</span></p>
                                </a>
                            </li>
                            <li>
                                <a href='mailto:{{ venue.email }}' target='_top'>
                                    <p><span class="color">{{ venue.email }}</span></p>
                                </a>
                            </li>
                        </ul>
                    </div> 
                    <hr>
                    <div class="cost">
                        <h5>Starting Cost: </h5>
                        <h3>{{ venue.minAmmount | currency }}</h3>
                    </div>
                    <hr>
                    <div class="capacity">
                         <h5>Capacity: </h5>
                         <h3>{{ venue.maxCapacity }}</h3>
                    </div>
                    <hr>
                    <mat-list [ngStyle]="{ 'width': '100%', 'display': 'block' }" *ngFor="let amenity of venue.amenities">
                        <mat-list-item>
                            <img src="/assets/images/checkbox.svg" alt="Check Box icon"> {{amenity.name}}
                        </mat-list-item>
                    </mat-list>
                    <hr>
                    <div>
                        <mat-card class="card">
                            <h6 class="text-center"><span>Featured Vendor</span></h6>
                            <ng-container *ngIf="vendor?.pic_url; else elseTemplate">
                                <div class="vendor-link">
                                    <!-- LIVE -->
                                    <div class="text-center">
                                        <a [routerLink]="['/vendor', 'display', vendor._id]">
                                            <img src='https://s3-us-west-2.amazonaws.com/tulsa-venues/Vendors/{{vendor._id}}/{{vendor.pic_url}}' class="img-thumbnail" id="vendor-image" alt="Vendor Picture" />
                                        </a>
                                    </div>
                                    <!-- TEST -->
                                    <!-- <div class="text-center">
                                        <a [routerLink]="['/vendor', 'display', vendor._id]">
                                            <img src='https://venue-test.s3.amazonaws.com/Vendors/{{vendor._id}}/{{vendor.pic_url}}' class="img-thumbnail" id="vendor-image" alt="Vendor Picture" />
                                        </a>
                                    </div> -->
                                </div>
                            </ng-container>
                            <ng-template #elseTemplate>
                                <div class="vendor-link">
                                    <a [routerLink]="['/vendor', 'display', vendor._id]">
                                        <img src='/assets/images/missing.png' class="img-thumbnail" id="vendor-image" alt="Venue Picture">
                                    </a>
                                </div>
                            </ng-template>
                            <mat-card-title>
                                <h5 class="text-center">{{vendor?.name}}</h5>
                                <span class="line"></span>
                                <mat-card-subtitle class="text-center">{{vendor._category.name | titlecase}}</mat-card-subtitle>
                            </mat-card-title>
                            <mat-card-actions>
                                <div class="text-center">
                                    <button mat-button [routerLink]="['/vendor', 'display', vendor._id]" matTooltip="View {{vendor.name}}"><span>LEARN MORE</span></button>
                                </div>
                            </mat-card-actions>
                        </mat-card>
                    </div>
                </div>
                <div class="col-9" id="right-col">
                    <div id="top-right">
                        <div id="venue-about">
                            <div class="text-center">
                                <h2>{{venue.name}}</h2>
                                <p>{{venue.description}}</p>
                            </div>
                        </div>
                        <div class="links">
                            <div class="col-6">
                                <!-- LIVE -->
                                <div class="text-center">
                                    <img src="https://s3-us-west-2.amazonaws.com/tulsa-venues/Venues/{{venue._id}}/VideoPic/{{venue.videoPicURL}}" class="img-fluid img-thumbnail" alt="Venue Video">
                                </div>
                                <!-- TEST -->
                                <!-- <div class="text-center">
                                    <img src='https://venue-test.s3.amazonaws.com/Venues/{{venue._id}}/VideoPic/{{venue.videoPicURL}}' class="img-fluid img-thumbnail" alt="Venue Video">
                                </div> -->
                                <div class="text-center image-button">
                                    <a href="{{venue.video_url}}" target="_blank" class="white">
                                        <i class="material-icons" id="play-icon">&#xE037;</i>
                                        <h5 class="white" id="play-text">PLAY VIDEO</h5>
                                    </a>
                                </div>
                            </div>
                            <div class="col-6">
                                <!-- LIVE -->
                                <div class="text-center">
                                    <img src="https://s3-us-west-2.amazonaws.com/tulsa-venues/Venues/{{venue._id}}/{{venue.tourPicURL}}" class="img-fluid img-thumbnail" alt="Venue 3D Tour">
                                </div>
                                <!-- TEST -->
                                <!-- <div class="text-center">
                                    <img src='https://venue-test.s3.amazonaws.com/Venues/{{venue._id}}/TourPic/{{venue.tourPicURL}}' class="img-fluid img-thumbnail" alt="Venue 3D Tour">
                                </div> -->
                                <div class="text-center image-button">
                                    <button mat-button cdk-overlay-origin #trigger="cdkOverlayOrigin" (click)="isMenuOpen = !isMenuOpen" matTooltip="View 3D tour">
                                        <h5 class="white" id="play-text">3D TOUR</h5>
                                    </button>
                                </div>
                                <ng-template cdk-connected-overlay [origin]="trigger" [width]="900" hasBackdrop [open]="isMenuOpen" (backdropClick)="isMenuOpen=false">
                                    <div class="overlay">
                                        <div class="embed-responsive embed-responsive-16by9" id="content">
                                            <iframe class="embed-responsive-item" [src]='sanitizer.bypassSecurityTrustResourceUrl(venue.tour_url)' scrolling="no"></iframe>
                                        </div>
                                    </div>
                                </ng-template>
                            </div>
                        </div>
                    
                        <div *ngFor="let gallery of venue.gallery" id="gallery">
                            <div class="col-2">
                                <!-- LIVE -->
                                <img src="https://s3-us-west-2.amazonaws.com/tulsa-venues/Venues/{{venue._id}}/Gallery/{{gallery.name}}" alt="Venue Gallery Picture" class="img-thumbnail gallery-image">
                                <!-- TEST -->
                                <!-- <img src='https://venue-test.s3.amazonaws.com/Venues/{{venue._id}}/Gallery/{{gallery.name}}' class="img-thumbnail gallery-image" alt="Venue gallery picture"> -->
                            </div>
                        </div>  
                    </div>
                    <div class="reviews">
                        <h2 class="text-center">Reviews</h2>
                        <div class="clearfix">
                            <button mat-button color="primary" [routerLink]="['/venue', venue._id, 'review']" class="float-right">Add a Review</button>
                        </div>
                        <span class="line"></span>
                        <div *ngFor="let review of venue.reviews">
                            <ng-container *ngIf="review.approved">
                                <mat-card>
                                    <mat-card-header>
                                        <mat-card-title>
                                            {{review.title}}
                                            <br>
                                            <div id="rating">
                                                <i class="material-icons" value="1">&#xE83A;</i>
                                                <i class="material-icons" value="2">&#xE83A;</i>
                                                <i class="material-icons" value="3">&#xE83A;</i>
                                                <i class="material-icons" value="4">&#xE83A;</i>
                                                <i class="material-icons" value="5">&#xE83A;</i>
                                            </div>
                                        </mat-card-title>
                                    </mat-card-header>
                                    <mat-card-content>
                                        <p>{{review.content}}</p>
                                    </mat-card-content>
                                    <mat-card-actions>
                                        <button mat-button>Mark Review as Helpful</button>
                                        <button mat-button>Report</button>
                                    </mat-card-actions>
                                </mat-card>
                            </ng-container>
                        </div>
                        <ng-container *ngIf="!venue.reviews">
                            <div class="text-center">
                                <p>There are no reviews for {{venue?.name}}</p>
                            </div>
                        </ng-container>
                    </div>
                </div>
                <div id="none-scroll">
                    <div class="row">
                        <div class="col-3"></div>
                        <div class="col-9" id="bottom-map">
                            <div class="map">
                                <agm-map [latitude]='venue.lat' [longitude]='venue.lng' [zoom]="zoom" [disableDefaultUI]="false" [zoomControl]="false">
                                    <agm-marker [title]="venue.address" [latitude]="venue.lat" [longitude]="venue.lng">
                                        <agm-snazzy-info-window [maxWidth]="400" [padding]="0" [closeWhenOthersOpen]="true">
                                            <ng-template>
                                                <mat-card class="mat-card">
                                                    <mat-card-header>
                                                        <!-- LIVE -->
                                                        <img mat-card-avatar src='https://s3-us-west-2.amazonaws.com/tulsa-venues/Venues/{{venue._id}}/{{venue.pic_url}}' alt="Venue Avatar Picture">
                                                        <!-- TEST -->
                                                        <!-- <img mat-card-avatar src="https://venue-test.s3.amazonaws.com/Venues/{{venue._id}}/{{venue.pic_url}}" alt="Venue Avatar Picture"> -->
                                                    </mat-card-header>
                                                    <mat-card-content class="text-center">
                                                        <mat-card-subtitle>
                                                            <h6>{{venue?.name}}</h6>
                                                            <h6>{{venue?.address}}</h6>
                                                        </mat-card-subtitle>
                                                    </mat-card-content>
                                                </mat-card>
                                            </ng-template>
                                        </agm-snazzy-info-window>
                                    </agm-marker>
                                </agm-map>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-template>
